<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine's 3x3 Puzzle ❤️</title>
<style>
  /* === Page Styling === */
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: #FFF4E1; /* soft cream */
    height: 100vh;
    margin: 0;
  }

  h1 {
    color: #6A2C2C; /* deep red/brown */
    text-align: center;
    margin-bottom: 20px;
  }

  /* === Puzzle Grid === */
  #puzzle {
    display: grid;
    grid-template-columns: repeat(3, 200px);
    grid-template-rows: repeat(3, 150px); /* 4:3 aspect ratio */
    gap: 2px;
  }

  /* === Puzzle Pieces === */
  .piece {
    width: 200px;
    height: 150px;
    background-image: url('photo.png'); /* replace with your photo */
    background-size: 600px 450px; /* scaled display */
    border: 2px solid #B33A3A; /* deep red */
    box-sizing: border-box;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    transition: transform 0.2s ease; /* subtle hover effect */
  }

  .piece:hover {
    transform: scale(1.05);
    border-color: #E07A5F; /* warm coral hover */
  }

  /* === Empty Slot === */
  .empty {
    background: none;
    border: 2px dashed #D9A066; /* warm gold */
  }

  /* === Message === */
  #message {
    margin-top: 20px;
    font-size: 1.5em;
    color: #B33A3A; /* matches piece border */
    display: none;
    text-align: center;
  }
</style>
</head>
<body>

<h1>You're the Missing Piece</h1>
<div id="puzzle"></div>
<div id="message">Super secret clue</div>

<script>
const rows = 3;
const cols = 3;
const puzzle = document.getElementById('puzzle');
const message = document.getElementById('message');

// Initialize grid
let grid = [];
for (let i = 0; i < rows * cols - 1; i++) {
    grid.push(i);
}
grid.push(null); // empty slot
shuffleGrid();

// Render puzzle
function render() {
    puzzle.innerHTML = '';
    for (let i = 0; i < rows * cols; i++) {
        const piece = document.createElement('div');
        if (grid[i] === null) {
            piece.classList.add('piece', 'empty');
        } else {
            piece.classList.add('piece');
            piece.style.backgroundPosition = `-${(grid[i] % cols) * 200}px -${Math.floor(grid[i] / cols) * 150}px`;
        }
        piece.dataset.index = i;
        piece.addEventListener('click', () => movePiece(i));
        puzzle.appendChild(piece);
    }
}

// Shuffle the grid (solvable)
function shuffleGrid() {
    do {
        grid = grid.filter(v => v !== null).sort(() => Math.random() - 0.5);
        grid.push(null);
    } while (!isSolvable(grid));
}

// Check solvability
function isSolvable(arr) {
    let inversions = 0;
    const nums = arr.filter(n => n !== null);
    for (let i = 0; i < nums.length - 1; i++) {
        for (let j = i + 1; j < nums.length; j++) {
            if (nums[i] > nums[j]) inversions++;
        }
    }
    return inversions % 2 === 0;
}

// Move piece if adjacent to empty
function movePiece(index) {
    const emptyIndex = grid.indexOf(null);
    const [row1, col1] = [Math.floor(index / cols), index % cols];
    const [row2, col2] = [Math.floor(emptyIndex / cols), emptyIndex % cols];
    const isAdjacent = (row1 === row2 && Math.abs(col1 - col2) === 1) ||
                       (col1 === col2 && Math.abs(row1 - row2) === 1);
    if (isAdjacent) {
        [grid[index], grid[emptyIndex]] = [grid[emptyIndex], grid[index]];
        render();
        checkComplete();
    }
}

// Check if puzzle is solved
function checkComplete() {
    for (let i = 0; i < rows * cols - 1; i++) {
        if (grid[i] !== i) return;
    }
    message.style.display = 'block';
}

render();
</script>

</body>
</html>